<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GEMINI_ULTRA_V12_FIXED</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
        body { background: #010101; color: #00ff41; font-family: 'Share Tech Mono', monospace; height: 100dvh; display: flex; flex-direction: column; overflow: hidden; }
        .hacker-border { border: 1px solid rgba(0, 255, 65, 0.4); background: rgba(0, 10, 0, 0.9); box-shadow: 0 0 10px rgba(0, 255, 65, 0.1); }
        .scan-line { position: absolute; width: 100%; height: 2px; background: #00ff41; top: 0; animation: scan 1.5s linear infinite; display: none; opacity: 0.8; }
        @keyframes scan { 0% { top: 0; } 100% { top: 100%; } }
        #vid { width: 100%; border-radius: 4px; display: none; margin-top: 10px; border: 1px solid #00441b; }
        .log-stream { font-size: 10px; color: #008f11; overflow-y: auto; height: 100px; border-top: 1px solid #111; padding-top: 5px; }
    </style>
</head>
<body class="p-3">

    <header class="flex justify-between items-center mb-3 border-b border-green-900 pb-2">
        <div class="flex items-center gap-2">
            <i data-lucide="zap" class="text-yellow-500 animate-pulse"></i>
            <h1 class="text-sm font-bold tracking-widest uppercase">CRACKER_V12_STABLE</h1>
        </div>
        <div class="text-[9px] bg-red-900/40 px-2 py-1 rounded text-red-400">MODEL_FIX_ACTIVE</div>
    </header>

    <div class="flex-grow overflow-y-auto space-y-3 pr-1">
        
        <div class="hacker-border p-4 rounded-lg relative overflow-hidden">
            <div id="scanner" class="scan-line"></div>
            <label class="text-[10px] opacity-50 uppercase block mb-2">Target_Media_File</label>
            <input type="file" id="vidInp" accept="video/*" class="hidden" onchange="initVid(this)">
            <button onclick="document.getElementById('vidInp').click()" class="w-full bg-green-900/10 border border-green-500/50 py-5 font-bold text-xs flex items-center justify-center gap-2">
                <i data-lucide="file-video"></i> SELECT VIDEO (UP TO 2 MINS)
            </button>
            <video id="vid" muted playsinline></video>
        </div>

        <div id="logs" class="log-stream font-mono">
            <div>> System: Model path updated to gemini-1.5-flash-latest.</div>
            <div>> Status: Awaiting 2min video payload...</div>
        </div>

        <button id="mainBtn" onclick="runScan()" class="hidden w-full bg-green-600 text-black py-4 font-black rounded uppercase text-sm shadow-[0_0_20px_rgba(0,255,65,0.4)]">
            Run Deep Frame Scan (Optimized)
        </button>

        <div id="intel" class="hacker-border p-4 rounded-xl min-h-[160px] text-xs leading-relaxed mb-10 overflow-y-auto max-h-[300px]">
            <div class="opacity-20 italic">Awaiting AI analysis results...</div>
        </div>
    </div>

    <canvas id="canvas" style="display:none;"></canvas>

    <script>
        lucide.createIcons();
        
        // API KEY & MODEL CONFIG
        const API_KEY = "AIzaSyBcqimHqJ6QmtiqaSEjmN0vzCG5A6ZbqYY"; 
        const MODEL_ID = "gemini-1.5-flash-latest"; // Fixed path for v1beta

        function addLog(m, type = 'info') {
            const l = document.getElementById('logs');
            const color = type === 'err' ? 'text-red-500' : 'text-green-500';
            l.innerHTML += `<div class="${color}">> ${m}</div>`;
            l.scrollTop = l.scrollHeight;
        }

        function initVid(input) {
            if(!input.files[0]) return;
            const v = document.getElementById('vid');
            v.src = URL.createObjectURL(input.files[0]);
            v.style.display = 'block';
            v.onloadedmetadata = () => {
                document.getElementById('mainBtn').classList.remove('hidden');
                addLog(`TARGET_LOCKED: ${v.duration.toFixed(1)}s Detected.`);
            };
        }

        async function runScan() {
            const v = document.getElementById('vid');
            const btn = document.getElementById('mainBtn');
            const scan = document.getElementById('scanner');
            const canv = document.getElementById('canvas');
            const ctx = canv.getContext('2d');
            const intel = document.getElementById('intel');

            btn.disabled = true;
            btn.innerText = "CRACKING VIDEO...";
            scan.style.display = 'block';
            intel.innerHTML = "<span class='animate-pulse text-green-400'>[SYSTEM]: Watching video frames...</span>";

            const frames = [];
            const steps = 12; // 2 min video ke liye 12 frames (better coverage)
            const gap = v.duration / (steps + 1);

            try {
                for(let i=1; i<=steps; i++) {
                    v.currentTime = i * gap;
                    await new Promise(r => v.onseeked = r);
                    
                    // Optimization: Standard scale for fast processing
                    const scale = 640 / v.videoWidth;
                    canv.width = 640;
                    canv.height = v.videoHeight * scale;
                    
                    ctx.drawImage(v, 0, 0, canv.width, canv.height);
                    frames.push(canv.toDataURL('image/jpeg', 0.5).split(',')[1]);
                    addLog(`SCANNING: Frame ${i}/${steps} captured.`);
                }

                addLog("UPLOADING: Analyzing through Gemini Deep-Vision Engine...");

                const payload = {
                    contents: [{
                        parts: [
                            { text: "INSTRUCTIONS: You are a password recovery AI. Look at these frames from a video. Find any password, zip code, or key shown on the screen. If found in parts, combine them. Be very brief and direct." },
                            ...frames.map(f => ({ inline_data: { mime_type: "image/jpeg", data: f } }))
                        ]
                    }]
                };

                // UPDATED ENDPOINT PATH
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${MODEL_ID}:generateContent?key=${API_KEY}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload)
                });

                const data = await response.json();
                
                if(data.error) throw new Error(data.error.message);

                const result = data.candidates[0].content.parts[0].text;
                intel.innerHTML = `<div class="text-red-500 font-bold mb-2 underline">[SCAN_COMPLETE]</div><div class="text-white">${result.replace(/\n/g, '<br>')}</div>`;
                addLog("SUCCESS: Data successfully extracted.");

            } catch(e) {
                addLog("CRITICAL_ERROR: " + e.message, 'err');
                intel.innerHTML = `<span class="text-red-600 font-bold">CRACKING_FAILED:</span><br>${e.message}`;
            } finally {
                btn.disabled = false;
                btn.innerText = "Run Deep Frame Scan (Optimized)";
                scan.style.display = 'none';
            }
        }
    </script>
</body>
</html>
